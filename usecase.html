<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>Usecase - DRAFT PH Road Safety Implementation Guide v0.2.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"7"}
    h3,h4,h5,h6{--heading-prefix:"7"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->

        <!-- Placeholder for child template header declarations -->


        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">DRAFT PH Road Safety Implementation Guide</span>
            <br/>
            <span style="display:inline-block;">0.2.0 - ci-build



  <img alt="Philippines flag" src="assets/images/phl.svg" height="16" title="Philippines"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
  <li>
    <a href="toc.html">Table of Contents</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Usecase Guide
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="usecase.html">Use Case navigation</a>
      </li>
      <li>
        <a href="usecase.html#high-level-overview">High Level Flow</a>
      </li>
      <li>
        <a href="usecase.html#ems-decision-flow-submitupdatecancel">EMS decision flow</a>
      </li>
      <li>
        <a href="usecase.html#facility-retrieval-alternatives">Facility retrieval</a>
      </li>
      <li>
        <a href="usecase-ph-core-interoperability.html">PH-CORE Interoperability</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Data Modelling
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="data-modelling.html">General model</a>
      </li>
      <li>
        <a href="StructureDefinition-ph-road-safety-logical-model.html">Logical model</a>
      </li>
      <li>
        <a href="ConceptMap-MDSRoadSafety2FHIR.html">Concept Map</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Artifacts
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="artifacts.html#1">Profiles</a>
      </li>
      <li>
        <a href="artifacts.html#2">Value Sets</a>
      </li>
      <li>
        <a href="artifacts.html#3">Code Systems</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="examples.html">Examples</a>
  </li>
  <li>
    <a href="downloads.html">Downloads</a>
  </li>
  <li>
    <a href="references.html">References</a>
  </li>
  <li>
    <a href="roadmap.html">Roadmap</a>
  </li>
  <li>
    <a href="http://hl7.org/fhir/us/example/history.html">History</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>Usecase</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">DRAFT PH Road Safety Implementation Guide - Local Development build (v0.2.0) built by the FHIR (HL7® FHIR® Standard) Build Tools. See the <a href='https://build.fhir.org/ig/UPM-NTHC/PH-RoadSafetyIG/history.html'>Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>Usecase</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#high-level-overview" id="markdown-toc-high-level-overview">High level Overview</a></li>
  <li><a href="#ems-decision-flow-submitupdatecancel" id="markdown-toc-ems-decision-flow-submitupdatecancel">EMS decision flow (submit/update/cancel)</a></li>
  <li><a href="#facility-retrieval-alternatives" id="markdown-toc-facility-retrieval-alternatives">Facility retrieval alternatives</a></li>
  <li><a href="#oneiss-etl--subscription-workflow--mock-script" id="markdown-toc-oneiss-etl--subscription-workflow--mock-script">ONEISS ETL — Subscription workflow &amp; mock script</a></li>
</ul>

</div>
<style>
/* Container centers inline content */
.svg-wrap {
  max-width: 100%;
  overflow: hidden;
  text-align: center; /* center smaller images without forcing them to grow */
}

/* Keep intrinsic size (no upscaling), allow downscaling to fit width,
   but constrain very tall/large images by viewport height so they don't stretch the page. */
.svg-wrap svg {
  display: inline-block;
  vertical-align: middle;
  max-width: 100%;       /* allow downscaling to container width */
  height: auto !important; 
  box-sizing: border-box;
}
</style>

<p>This page contains navigable use-case diagrams (Mermaid) that help implementers and integrators follow the common workflows in the Road Safety MDS: EMS run-report submission, Facility retrieval and intake, and optional Eligibility workflows.</p>

<p>Notes on diagrams</p>
<ul>
  <li>These diagrams are authored in Mermaid syntax so they render in the IG HTML output where Mermaid is supported.</li>
  <li>Use the diagrams to trace the happy path and alternative branches for each use case. Each node maps to an actionable step (API call, bundle composition, or policy decision).</li>
</ul>

<h3 id="high-level-overview">High level Overview</h3>

<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1246px" preserveAspectRatio="none" style="width:1022px;height:1246px;background:#FFFFFF;" version="1.1" viewBox="0 0 1022 1246" width="1022px" zoomAndPan="magnify"><title>Road Safety Data Exchange - High-Level Overview</title><defs /><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="396.7852" x="314.3687" y="27.9951">Road Safety Data Exchange - High-Level Overview</text><rect fill="#FFFFFF" height="1062.8516" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="764.5635" x="16" y="43.2969" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.5703" x="337.4966" y="55.3638">Scene to Facility</text><rect fill="none" height="105.6641" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="406.9463" x="10" y="317.7891" /><rect fill="none" height="178.7344" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="381.5913" x="296.1494" y="487.7188" /><rect fill="none" height="134.4688" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="490.4141" x="296.1494" y="680.4531" /><rect fill="none" height="90.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="598.8311" x="296.1494" y="828.9219" /><rect fill="none" height="75.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="720.373" x="296.1494" y="933.4531" /><g><title>EMS</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="43.5" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="139.7266" y2="1025.8516" /></g><g><title>FHIR Server</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="352.5479" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="356.1494" x2="356.1494" y1="139.7266" y2="1025.8516" /></g><g><title>Facility EHR</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="619.0791" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="622.4175" x2="622.4175" y1="139.7266" y2="1025.8516" /></g><g><title>ONEISS API</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="730.144" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="733.7246" x2="733.7246" y1="139.7266" y2="1025.8516" /></g><g><title>DPWH/DOTr</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="831.772" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="835.5635" x2="835.5635" y1="139.7266" y2="1025.8516" /></g><g><title>Health Center</title><rect fill="#000000" fill-opacity="0.00000" height="886.125" width="8" x="946.7515" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="949.9805" x2="949.9805" y1="139.7266" y2="1025.8516" /></g><g class="participant participant-head" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="136.4248">EMS</text><ellipse cx="47.5" cy="78.9297" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,98.9297 C51.5,98.9297 54.5,98.9297 58.5,94.9297 C66.5,94.9297 74.5,102.9297 74.5,110.9297 L74.5,114.9297 C74.5,118.9297 70.5,122.9297 66.5,122.9297 L28.5,122.9297 C24.5,122.9297 20.5,118.9297 20.5,114.9297 L20.5,110.9297 C20.5,102.9297 28.5,94.9297 36.5,94.9297 C40.5,98.9297 43.5,98.9297 47.5,98.9297" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="1037.8467">EMS</text><ellipse cx="47.5" cy="1057.6484" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,1077.6484 C51.5,1077.6484 54.5,1077.6484 58.5,1073.6484 C66.5,1073.6484 74.5,1081.6484 74.5,1089.6484 L74.5,1093.6484 C74.5,1097.6484 70.5,1101.6484 66.5,1101.6484 L28.5,1101.6484 C24.5,1101.6484 20.5,1097.6484 20.5,1093.6484 L20.5,1089.6484 C20.5,1081.6484 28.5,1073.6484 36.5,1073.6484 C40.5,1077.6484 43.5,1077.6484 47.5,1077.6484" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="310.1494" y="104.4297" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="306.1494" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="313.1494" y="128.4248">FHIR Server</text></g><g class="participant participant-tail" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="310.1494" y="1024.8516" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="306.1494" y="1028.8516" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="313.1494" y="1048.8467">FHIR Server</text></g><g class="participant participant-head" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="578.4175" y="136.4248">Facility EHR</text><ellipse cx="623.0791" cy="78.9297" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M623.0791,98.9297 C627.0791,98.9297 630.0791,98.9297 634.0791,94.9297 C642.0791,94.9297 650.0791,102.9297 650.0791,110.9297 L650.0791,114.9297 C650.0791,118.9297 646.0791,122.9297 642.0791,122.9297 L604.0791,122.9297 C600.0791,122.9297 596.0791,118.9297 596.0791,114.9297 L596.0791,110.9297 C596.0791,102.9297 604.0791,94.9297 612.0791,94.9297 C616.0791,98.9297 619.0791,98.9297 623.0791,98.9297" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="578.4175" y="1037.8467">Facility EHR</text><ellipse cx="623.0791" cy="1057.6484" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M623.0791,1077.6484 C627.0791,1077.6484 630.0791,1077.6484 634.0791,1073.6484 C642.0791,1073.6484 650.0791,1081.6484 650.0791,1089.6484 L650.0791,1093.6484 C650.0791,1097.6484 646.0791,1101.6484 642.0791,1101.6484 L604.0791,1101.6484 C600.0791,1101.6484 596.0791,1097.6484 596.0791,1093.6484 L596.0791,1089.6484 C596.0791,1081.6484 604.0791,1073.6484 612.0791,1073.6484 C616.0791,1077.6484 619.0791,1077.6484 623.0791,1077.6484" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="691.7246" y="136.4248">ONEISS API</text><path d="M716.144,87.4297 C716.144,77.4297 734.144,77.4297 734.144,77.4297 C734.144,77.4297 752.144,77.4297 752.144,87.4297 L752.144,113.4297 C752.144,123.4297 734.144,123.4297 734.144,123.4297 C734.144,123.4297 716.144,123.4297 716.144,113.4297 L716.144,87.4297" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M716.144,87.4297 C716.144,97.4297 734.144,97.4297 734.144,97.4297 C734.144,97.4297 752.144,97.4297 752.144,87.4297" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-tail" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="691.7246" y="1037.8467">ONEISS API</text><path d="M716.144,1051.1484 C716.144,1041.1484 734.144,1041.1484 734.144,1041.1484 C734.144,1041.1484 752.144,1041.1484 752.144,1051.1484 L752.144,1077.1484 C752.144,1087.1484 734.144,1087.1484 734.144,1087.1484 C734.144,1087.1484 716.144,1087.1484 716.144,1077.1484 L716.144,1051.1484" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M716.144,1051.1484 C716.144,1061.1484 734.144,1061.1484 734.144,1061.1484 C734.144,1061.1484 752.144,1061.1484 752.144,1051.1484" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-head" data-participant="DPWH"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="98.417" x="786.5635" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.417" x="793.5635" y="128.4248">DPWH/DOTr</text></g><g class="participant participant-tail" data-participant="DPWH"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="98.417" x="786.5635" y="1024.8516" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.417" x="793.5635" y="1044.8467">DPWH/DOTr</text></g><g class="participant participant-head" data-participant="HC"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="111.542" x="894.9805" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.542" x="901.9805" y="128.4248">Health Center</text></g><g class="participant participant-tail" data-participant="HC"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="111.542" x="894.9805" y="1024.8516" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.542" x="901.9805" y="1044.8467">Health Center</text></g><path d="M223,164.7266 L223,199.7266 A10,10 0 0 0 233,209.7266 L478,209.7266 A10,10 0 0 0 488,199.7266 L488,164.7266 L478,154.7266 L233,154.7266 A10,10 0 0 0 223,164.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M478,154.7266 L478,159.7266 A5,5 0 0 0 483,164.7266 L488,164.7266 L478,154.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.3218" x="229" y="171.7935">Central FHIR Server (ONEISS / NHDR)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.0864" x="229" y="186.9263">Routes, checks, and shares records</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1182" x="229" y="202.0591">Supports Subscription delivery to ETL</text><path d="M52,230.125 L52,295.125 A10,10 0 0 0 62,305.125 L266,305.125 A10,10 0 0 0 276,295.125 L276,230.125 L266,220.125 L62,220.125 A10,10 0 0 0 52,230.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M266,220.125 L266,225.125 A5,5 0 0 0 271,230.125 L276,230.125 L266,220.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.1919" x="58" y="237.1919">Scene capture:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0947" x="58" y="252.3247">- Incident/Encounter</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.6724" x="58" y="267.4575">- Patient</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.2393" x="58" y="282.5903">- Vitals &amp; notes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.4805" x="58" y="297.7231">- Run Report form/attachments</text><path d="M20,317.7891 L307.9985,317.7891 L307.9985,324.9219 L297.9985,334.9219 L10,334.9219 L10,327.7891 A10,10 0 0 1 20,317.7891" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="105.6641" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="406.9463" x="10" y="317.7891" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252.9985" x="25" y="330.856">Scene to EMS Transport Reporting</text><g class="message" data-participant-1="EMS" data-participant-2="FHIR"><polygon fill="#181818" points="344.5479,367.1875,354.5479,371.1875,344.5479,375.1875,348.5479,371.1875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="47.5" x2="350.5479" y1="371.1875" y2="371.1875" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.1953" x="54.5" y="350.9888">Send Run Report</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.0479" x="54.5" y="366.1216">(Incident + Patient + Vitals + Attachments)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EMS"><polygon fill="#181818" points="58.5,411.4531,48.5,415.4531,58.5,419.4531,54.5,415.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="52.5" x2="355.5479" y1="415.4531" y2="415.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.0483" x="64.5" y="395.2544">Confirm receipt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3398" x="64.5" y="410.3872">(Incident reference)</text></g><path d="M512,445.4531 L512,465.4531 A10,10 0 0 0 522,475.4531 L723,475.4531 A10,10 0 0 0 733,465.4531 L733,445.4531 L723,435.4531 L522,435.4531 A10,10 0 0 0 512,445.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M723,435.4531 L723,440.4531 A5,5 0 0 0 728,445.4531 L733,445.4531 L723,435.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.77" x="518" y="452.52">Prefill triage and handoff using</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.1577" x="518" y="467.6528">incident and vitals from EMS</text><path d="M306.1494,487.7188 L399.0908,487.7188 L399.0908,494.8516 L389.0908,504.8516 L296.1494,504.8516 L296.1494,497.7188 A10,10 0 0 1 306.1494,487.7188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="178.7344" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="381.5913" x="296.1494" y="487.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53.4155" x="311.1494" y="500.7856">Facility</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="66.2632" x="414.0908" y="499.9292">[Retrieval]</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="367.5479,521.9844,357.5479,525.9844,367.5479,529.9844,363.5479,525.9844" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5479" x2="622.0791" y1="525.9844" y2="525.9844" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.5313" x="373.5479" y="520.9185">Retrieve Incident &amp; Patient Summary</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="611.0791,566.25,621.0791,570.25,611.0791,574.25,615.0791,570.25" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="356.5479" x2="617.0791" y1="570.25" y2="570.25" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6479" x="363.5479" y="550.0513">Provide Summary</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.0483" x="363.5479" y="565.1841">(Encounter + Patient snapshot)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="296.1494" x2="677.7407" y1="579.25" y2="579.25" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.168" x="301.1494" y="589.4604">[Submission]</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="367.5479,625.3203,357.5479,629.3203,367.5479,633.3203,363.5479,629.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5479" x2="622.0791" y1="629.3203" y2="629.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.8813" x="373.5479" y="609.1216">Share Facility Care Update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.9082" x="373.5479" y="624.2544">(Triage, diagnoses, procedures)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="611.0791,654.4531,621.0791,658.4531,611.0791,662.4531,615.0791,658.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="356.5479" x2="617.0791" y1="658.4531" y2="658.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="363.5479" y="653.3872">Update confirmed</text></g><path d="M306.1494,680.4531 L502.8115,680.4531 L502.8115,687.5859 L492.8115,697.5859 L296.1494,697.5859 L296.1494,690.4531 A10,10 0 0 1 306.1494,680.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="134.4688" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="490.4141" x="296.1494" y="680.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="161.6621" x="311.1494" y="693.52">ONEISS ETL (optional)</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="722.144,729.8516,732.144,733.8516,722.144,737.8516,726.144,733.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="356.5479" x2="728.144" y1="733.8516" y2="733.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.9438" x="363.5479" y="713.6528">Subscription notification (POST /notifications)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.7271" x="367.6802" y="728.7856">Transform to ONEISS compatible data</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="296.1494" x2="786.5635" y1="742.8516" y2="742.8516" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.3955" x="301.1494" y="753.062">[Alternative]</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="722.144,773.7891,732.144,777.7891,722.144,781.7891,726.144,777.7891" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="356.5479" x2="728.144" y1="777.7891" y2="777.7891" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.5962" x="363.5479" y="772.7231">Scheduled push of reports in ONEISS Compatible Data</text></g><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="722.144,802.9219,732.144,806.9219,722.144,810.9219,726.144,806.9219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="356.5479" x2="728.144" y1="806.9219" y2="806.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.978" x="363.5479" y="801.856">Or Manual export of reports</text></g><path d="M306.1494,828.9219 L472,828.9219 L472,836.0547 L462,846.0547 L296.1494,846.0547 L296.1494,838.9219 A10,10 0 0 1 306.1494,828.9219" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="90.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="598.8311" x="296.1494" y="828.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130.8506" x="311.1494" y="841.9888">Agency Reporting</text><g class="message" data-participant-1="DPWH" data-participant-2="FHIR"><polygon fill="#181818" points="367.5479,863.1875,357.5479,867.1875,367.5479,871.1875,363.5479,867.1875" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="823.772,863.1875,833.772,867.1875,823.772,871.1875,827.772,867.1875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5479" x2="829.772" y1="867.1875" y2="867.1875" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.5562" x="373.5479" y="862.1216">Request Agency Report</text></g><g class="message" data-participant-1="FHIR" data-participant-2="DPWH"><polygon fill="#181818" points="823.772,907.4531,833.772,911.4531,823.772,915.4531,827.772,911.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="356.5479" x2="829.772" y1="911.4531" y2="911.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5034" x="363.5479" y="891.2544">Provide Report</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0532" x="363.5479" y="906.3872">(Required reporting fields)</text></g><path d="M306.1494,933.4531 L450.8369,933.4531 L450.8369,940.5859 L440.8369,950.5859 L296.1494,950.5859 L296.1494,943.4531 A10,10 0 0 1 306.1494,933.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="75.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="720.373" x="296.1494" y="933.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.6875" x="311.1494" y="946.52">Follow-up Care</text><g class="message" data-participant-1="HC" data-participant-2="FHIR"><polygon fill="#181818" points="367.5479,967.7188,357.5479,971.7188,367.5479,975.7188,363.5479,971.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5479" x2="949.7515" y1="971.7188" y2="971.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.8857" x="373.5479" y="966.6528">Request Patient/Encounter for follow-up</text></g><g class="message" data-participant-1="FHIR" data-participant-2="HC"><polygon fill="#181818" points="938.7515,996.8516,948.7515,1000.8516,938.7515,1004.8516,942.7515,1000.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="356.5479" x2="944.7515" y1="1000.8516" y2="1000.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.376" x="363.5479" y="995.7856">Provide Care Continuity Data</text></g><rect fill="#DDDDDD" height="107.7813" rx="10" ry="10" style="stroke:#000000;stroke-width:1;" width="385.6484" x="12" y="1119.1484" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.6455" x="17" y="1137.1436">Key concepts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="348.5508" x="17" y="1153.4404">- Encounter connects EMS scene and Facility care</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="296.8232" x="17" y="1169.7373">- Patient identity is shared across systems</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="329.1436" x="17" y="1186.0342">- Observations &amp; Documents add clinical detail</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="375.6484" x="17" y="1202.3311">- Organization identifies EMS, Facilities, and Agencies</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="368.6416" x="17" y="1218.6279">- ETL can subscribe/pull/transform data for reporting</text></g></svg>
</div>

<h4 id="low-level-overview">Low level Overview</h4>

<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1375px" preserveAspectRatio="none" style="width:1153px;height:1375px;background:#FFFFFF;" version="1.1" viewBox="0 0 1153 1375" width="1153px" zoomAndPan="magnify"><title>Road Safety Data Exchange - Central FHIR Server</title><defs /><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="390.585" x="382.8528" y="27.9951">Road Safety Data Exchange - Central FHIR Server</text><rect fill="#FFFFFF" height="1207.9844" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="895.3315" x="16" y="43.2969" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.5703" x="402.8806" y="55.3638">Scene to Facility</text><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="411.9482" x="10" y="222.125" /><rect fill="none" height="350.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="521.3413" x="301.1514" y="376.9219" /><rect fill="none" height="163.6016" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="616.1802" x="301.1514" y="741.3203" /><rect fill="none" height="110.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="724.5972" x="301.1514" y="918.9219" /><rect fill="none" height="110.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="846.1392" x="301.1514" y="1043.4531" /><g><title>EMS</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="43.5" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="139.7266" y2="1170.9844" /></g><g><title>FHIR Server</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="357.5498" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="361.1514" x2="361.1514" y1="139.7266" y2="1170.9844" /></g><g><title>Facility EHR</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="763.8311" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="767.1694" x2="767.1694" y1="139.7266" y2="1170.9844" /></g><g><title>ONEISS API</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="860.9121" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="864.4927" x2="864.4927" y1="139.7266" y2="1170.9844" /></g><g><title>DPWH/DOTr</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="962.54" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="966.3315" x2="966.3315" y1="139.7266" y2="1170.9844" /></g><g><title>Health Center</title><rect fill="#000000" fill-opacity="0.00000" height="1031.2578" width="8" x="1077.5195" y="139.7266" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080.7485" x2="1080.7485" y1="139.7266" y2="1170.9844" /></g><g class="participant participant-head" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="136.4248">EMS</text><ellipse cx="47.5" cy="78.9297" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,98.9297 C51.5,98.9297 54.5,98.9297 58.5,94.9297 C66.5,94.9297 74.5,102.9297 74.5,110.9297 L74.5,114.9297 C74.5,118.9297 70.5,122.9297 66.5,122.9297 L28.5,122.9297 C24.5,122.9297 20.5,118.9297 20.5,114.9297 L20.5,110.9297 C20.5,102.9297 28.5,94.9297 36.5,94.9297 C40.5,98.9297 43.5,98.9297 47.5,98.9297" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="1182.9795">EMS</text><ellipse cx="47.5" cy="1202.7813" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,1222.7813 C51.5,1222.7813 54.5,1222.7813 58.5,1218.7813 C66.5,1218.7813 74.5,1226.7813 74.5,1234.7813 L74.5,1238.7813 C74.5,1242.7813 70.5,1246.7813 66.5,1246.7813 L28.5,1246.7813 C24.5,1246.7813 20.5,1242.7813 20.5,1238.7813 L20.5,1234.7813 C20.5,1226.7813 28.5,1218.7813 36.5,1218.7813 C40.5,1222.7813 43.5,1222.7813 47.5,1222.7813" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="315.1514" y="104.4297" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="311.1514" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="318.1514" y="128.4248">FHIR Server</text></g><g class="participant participant-tail" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="315.1514" y="1169.9844" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="311.1514" y="1173.9844" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="318.1514" y="1193.9795">FHIR Server</text></g><g class="participant participant-head" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="723.1694" y="136.4248">Facility EHR</text><ellipse cx="767.8311" cy="78.9297" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M767.8311,98.9297 C771.8311,98.9297 774.8311,98.9297 778.8311,94.9297 C786.8311,94.9297 794.8311,102.9297 794.8311,110.9297 L794.8311,114.9297 C794.8311,118.9297 790.8311,122.9297 786.8311,122.9297 L748.8311,122.9297 C744.8311,122.9297 740.8311,118.9297 740.8311,114.9297 L740.8311,110.9297 C740.8311,102.9297 748.8311,94.9297 756.8311,94.9297 C760.8311,98.9297 763.8311,98.9297 767.8311,98.9297" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="723.1694" y="1182.9795">Facility EHR</text><ellipse cx="767.8311" cy="1202.7813" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M767.8311,1222.7813 C771.8311,1222.7813 774.8311,1222.7813 778.8311,1218.7813 C786.8311,1218.7813 794.8311,1226.7813 794.8311,1234.7813 L794.8311,1238.7813 C794.8311,1242.7813 790.8311,1246.7813 786.8311,1246.7813 L748.8311,1246.7813 C744.8311,1246.7813 740.8311,1242.7813 740.8311,1238.7813 L740.8311,1234.7813 C740.8311,1226.7813 748.8311,1218.7813 756.8311,1218.7813 C760.8311,1222.7813 763.8311,1222.7813 767.8311,1222.7813" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="822.4927" y="136.4248">ONEISS API</text><path d="M846.9121,87.4297 C846.9121,77.4297 864.9121,77.4297 864.9121,77.4297 C864.9121,77.4297 882.9121,77.4297 882.9121,87.4297 L882.9121,113.4297 C882.9121,123.4297 864.9121,123.4297 864.9121,123.4297 C864.9121,123.4297 846.9121,123.4297 846.9121,113.4297 L846.9121,87.4297" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M846.9121,87.4297 C846.9121,97.4297 864.9121,97.4297 864.9121,97.4297 C864.9121,97.4297 882.9121,97.4297 882.9121,87.4297" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-tail" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="822.4927" y="1182.9795">ONEISS API</text><path d="M846.9121,1196.2813 C846.9121,1186.2813 864.9121,1186.2813 864.9121,1186.2813 C864.9121,1186.2813 882.9121,1186.2813 882.9121,1196.2813 L882.9121,1222.2813 C882.9121,1232.2813 864.9121,1232.2813 864.9121,1232.2813 C864.9121,1232.2813 846.9121,1232.2813 846.9121,1222.2813 L846.9121,1196.2813" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M846.9121,1196.2813 C846.9121,1206.2813 864.9121,1206.2813 864.9121,1206.2813 C864.9121,1206.2813 882.9121,1206.2813 882.9121,1196.2813" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-head" data-participant="DPWH"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="98.417" x="917.3315" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.417" x="924.3315" y="128.4248">DPWH/DOTr</text></g><g class="participant participant-tail" data-participant="DPWH"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="98.417" x="917.3315" y="1169.9844" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.417" x="924.3315" y="1189.9795">DPWH/DOTr</text></g><g class="participant participant-head" data-participant="HC"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="111.542" x="1025.7485" y="108.4297" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.542" x="1032.7485" y="128.4248">Health Center</text></g><g class="participant participant-tail" data-participant="HC"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="111.542" x="1025.7485" y="1169.9844" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.542" x="1032.7485" y="1189.9795">Health Center</text></g><path d="M228,164.7266 L228,199.7266 A10,10 0 0 0 238,209.7266 L483,209.7266 A10,10 0 0 0 493,199.7266 L493,164.7266 L483,154.7266 L238,154.7266 A10,10 0 0 0 228,164.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M483,154.7266 L483,159.7266 A5,5 0 0 0 488,164.7266 L493,164.7266 L483,154.7266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.6963" x="234" y="171.7935">ONEISS / NHDR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.8828" x="234" y="186.9263">FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1182" x="234" y="202.0591">Supports Subscription delivery to ETL</text><path d="M20,222.125 L307.9985,222.125 L307.9985,229.2578 L297.9985,239.2578 L10,239.2578 L10,232.125 A10,10 0 0 1 20,222.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="411.9482" x="10" y="222.125" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252.9985" x="25" y="235.1919">Scene to EMS Transport Reporting</text><path d="M52,254.2578 L52,259.2578 A10,10 0 0 0 62,269.2578 L294,269.2578 A10,10 0 0 0 304,259.2578 L304,254.2578 L294,244.2578 L62,244.2578 A10,10 0 0 0 52,254.2578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M294,244.2578 L294,249.2578 A5,5 0 0 0 299,254.2578 L304,254.2578 L294,244.2578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.8672" x="58" y="261.3247">EMS* (Electronic Reporting system)</text><g class="message" data-participant-1="EMS" data-participant-2="FHIR"><polygon fill="#181818" points="349.5498,306.6563,359.5498,310.6563,349.5498,314.6563,353.5498,310.6563" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="47.5" x2="355.5498" y1="310.6563" y2="310.6563" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.6016" x="54.5" y="290.4575">POST Bundle.runreport</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.0498" x="54.5" y="305.5903">(Encounter.transport-runreport + resources)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EMS"><polygon fill="#181818" points="58.5,350.9219,48.5,354.9219,58.5,358.9219,54.5,354.9219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="52.5" x2="360.5498" y1="354.9219" y2="354.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.4233" x="64.5" y="334.7231">201 Created (Encounter id)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.5928" x="64.5" y="349.856">Validate &amp; index</text></g><path d="M311.1514,376.9219 L404.0928,376.9219 L404.0928,384.0547 L394.0928,394.0547 L301.1514,394.0547 L301.1514,386.9219 A10,10 0 0 1 311.1514,376.9219" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="350.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="521.3413" x="301.1514" y="376.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53.4155" x="316.1514" y="389.9888">Facility</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="66.2632" x="419.0928" y="389.1323">[Retrieval]</text><path d="M524,409.0547 L524,414.0547 A10,10 0 0 0 534,424.0547 L752,424.0547 A10,10 0 0 0 762,414.0547 L762,409.0547 L752,399.0547 L534,399.0547 A10,10 0 0 0 524,409.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M752,399.0547 L752,404.0547 A5,5 0 0 0 757,409.0547 L762,409.0547 L752,399.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.001" x="530" y="416.1216">Facility EHR (iHOMIS / other EHR)</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,446.3203,362.5498,450.3203,372.5498,454.3203,368.5498,450.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="766.8311" y1="450.3203" y2="450.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.2813" x="378.5498" y="445.2544">GET /Encounter?identifier=IncidentNo|&lt;system&gt;|&lt;value&gt;</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="755.8311,475.4531,765.8311,479.4531,755.8311,483.4531,759.8311,479.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="761.8311" y1="479.4531" y2="479.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.2285" x="368.5498" y="474.3872">200 Bundle (Encounter + subject)</text></g><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,504.5859,362.5498,508.5859,372.5498,512.5859,368.5498,508.5859" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="766.8311" y1="508.5859" y2="508.5859" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.1602" x="378.5498" y="503.52">GET /Observation?encounter={id}&amp;category=vital-signs</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="755.8311,533.7188,765.8311,537.7188,755.8311,541.7188,759.8311,537.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="761.8311" y1="537.7188" y2="537.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.917" x="368.5498" y="532.6528">200 Bundle (Vitals at scene)</text></g><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,562.8516,362.5498,566.8516,372.5498,570.8516,368.5498,566.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="766.8311" y1="566.8516" y2="566.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.7944" x="378.5498" y="561.7856">GET /DocumentReference?context-encounter={id}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="755.8311,591.9844,765.8311,595.9844,755.8311,599.9844,759.8311,595.9844" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="761.8311" y1="595.9844" y2="595.9844" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.2114" x="368.5498" y="590.9185">200 Bundle (Run form, attachments)</text></g><path d="M401,618.9844 L401,623.9844 A10,10 0 0 0 411,633.9844 L752,633.9844 A10,10 0 0 0 762,623.9844 L762,618.9844 L752,608.9844 L411,608.9844 A10,10 0 0 0 401,618.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M752,608.9844 L752,613.9844 A5,5 0 0 0 757,618.9844 L762,618.9844 L752,608.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.6914" x="407" y="626.0513">Prefill triage, vitals, timestamps, crew handoff notes</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="301.1514" x2="822.4927" y1="640.1172" y2="640.1172" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.168" x="306.1514" y="650.3276">[Submission]</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,686.1875,362.5498,690.1875,372.5498,694.1875,368.5498,690.1875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="766.8311" y1="690.1875" y2="690.1875" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.1045" x="378.5498" y="669.9888">POST Bundle.facility</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.4253" x="378.5498" y="685.1216">(Encounter + clinical resources)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="755.8311,715.3203,765.8311,719.3203,755.8311,723.3203,759.8311,719.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="761.8311" y1="719.3203" y2="719.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="368.5498" y="714.2544">201 Created</text></g><path d="M311.1514,741.3203 L544.4141,741.3203 L544.4141,748.4531 L534.4141,758.4531 L301.1514,758.4531 L301.1514,751.3203 A10,10 0 0 1 311.1514,741.3203" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="163.6016" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="616.1802" x="301.1514" y="741.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="193.7368" x="316.1514" y="754.3872">ONEISS ETL (Subscription)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82.6987" x="559.4141" y="753.5308">[Hook based]</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="852.9121,790.7188,862.9121,794.7188,852.9121,798.7188,856.9121,794.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5498" x2="858.9121" y1="794.7188" y2="794.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.041" x="368.5498" y="774.52">POST /notifications (Subscription delivery)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323.4829" x="368.5498" y="789.6528">Transform 200 /SOAP Bundle (facility submission)</text></g><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,819.8516,362.5498,823.8516,372.5498,827.8516,368.5498,823.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="366.5498" x2="863.9121" y1="823.8516" y2="823.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="378.5498" y="818.7856">201 Created</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="301.1514" x2="917.3315" y1="832.8516" y2="832.8516" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="272.8516" x="306.1514" y="843.062">[Alternative (Scheduled or Manual Trigger)]</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="852.9121,863.7891,862.9121,867.7891,852.9121,871.7891,856.9121,867.7891" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="361.5498" x2="858.9121" y1="867.7891" y2="867.7891" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414.0132" x="368.5498" y="862.7231">POST /SOAP Bundle  (transformed/normalized) every X seconds</text></g><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,892.9219,362.5498,896.9219,372.5498,900.9219,368.5498,896.9219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="366.5498" x2="863.9121" y1="896.9219" y2="896.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="378.5498" y="891.856">201 Created</text></g><path d="M311.1514,918.9219 L477.002,918.9219 L477.002,926.0547 L467.002,936.0547 L301.1514,936.0547 L301.1514,928.9219 A10,10 0 0 1 311.1514,918.9219" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="110.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="724.5972" x="301.1514" y="918.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="130.8506" x="316.1514" y="931.9888">Agency Reporting</text><path d="M684,951.0547 L684,956.0547 A10,10 0 0 0 694,966.0547 L951,966.0547 A10,10 0 0 0 961,956.0547 L961,951.0547 L951,941.0547 L694,941.0547 A10,10 0 0 0 684,951.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M951,941.0547 L951,946.0547 A5,5 0 0 0 956,951.0547 L961,951.0547 L951,941.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.2422" x="690" y="958.1216">DPWH/DOTr (Agency reporting system)</text><g class="message" data-participant-1="DPWH" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,988.3203,362.5498,992.3203,372.5498,996.3203,368.5498,992.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="965.54" y1="992.3203" y2="992.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.8623" x="378.5498" y="987.2544">GET /Encounter?service-provider=Org/{id}&amp;...</text></g><g class="message" data-participant-1="FHIR" data-participant-2="DPWH"><polygon fill="#181818" points="954.54,1017.4531,964.54,1021.4531,954.54,1025.4531,958.54,1021.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="960.54" y1="1021.4531" y2="1021.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.394" x="368.5498" y="1016.3872">200 Bundle (relevant agency report data)</text></g><path d="M311.1514,1043.4531 L455.8389,1043.4531 L455.8389,1050.5859 L445.8389,1060.5859 L301.1514,1060.5859 L301.1514,1053.4531 A10,10 0 0 1 311.1514,1043.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="110.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="846.1392" x="301.1514" y="1043.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="109.6875" x="316.1514" y="1056.52">Follow-up Care</text><path d="M742,1075.5859 L742,1080.5859 A10,10 0 0 0 752,1090.5859 L1065,1090.5859 A10,10 0 0 0 1075,1080.5859 L1075,1075.5859 L1065,1065.5859 L752,1065.5859 A10,10 0 0 0 742,1075.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M1065,1065.5859 L1065,1070.5859 A5,5 0 0 0 1070,1075.5859 L1075,1075.5859 L1065,1065.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312.9014" x="748" y="1082.6528">Health centers (iClinicSys, or other private EHR)</text><g class="message" data-participant-1="HC" data-participant-2="FHIR"><polygon fill="#181818" points="372.5498,1112.8516,362.5498,1116.8516,372.5498,1120.8516,368.5498,1116.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="366.5498" x2="1080.5195" y1="1116.8516" y2="1116.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.251" x="378.5498" y="1111.7856">GET /Patient/{id} or /Encounter?patient={id}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="HC"><polygon fill="#181818" points="1069.5195,1141.9844,1079.5195,1145.9844,1069.5195,1149.9844,1073.5195,1145.9844" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="361.5498" x2="1075.5195" y1="1145.9844" y2="1145.9844" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.7925" x="368.5498" y="1140.9185">200 Bundle (patient/encounter data)</text></g><rect fill="#DDDDDD" height="91.4844" rx="10" ry="10" style="stroke:#000000;stroke-width:1;" width="448.71" x="12" y="1264.2813" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.6455" x="17" y="1282.2764">Key concepts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="356.7881" x="17" y="1298.5732">- Presence of a ONEISS / NHDR central FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="372.2646" x="17" y="1314.8701">- Bundles carry Encounter, Observations, Documents</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="402.4658" x="17" y="1331.167">- Systems retrieve or submit via standard FHIR endpoints</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="438.71" x="17" y="1347.4639">- ETL subscribes to transform and normalize data for reporting</text></g></svg>
</div>

<p>ONEISS and NHDR can be run as a single FHIR Server. EMS posts run-report Bundles to that FHIR Server, facilities and agencies query the same endpoint, and updates are posted back so everyone sees a consistent record.</p>

<p>Actors</p>
<ul>
  <li>EMS: ambulance/run-reporting app that sends the initial Bundle.runreport.</li>
  <li>FHIR Server: unified ONEISS + NHDR endpoint that validates, stores, indexes, and serves queries.</li>
  <li>Facility EHR: looks up incidents and fetches related resources to prefill intake.</li>
  <li>DPWH/DOTr (agency): queries encounters for reporting.</li>
  <li>Health centers: query patient/encounter history for follow-up.</li>
</ul>

<p>Key use-cases (one-line)</p>
<ul>
  <li>UC1: EMS POST Bundle.runreport → FHIR Server validates, stores, returns 201 + Encounter.id.</li>
  <li>UC2: Facility GET /Encounter?identifier={IncidentNo} → FHIR Server returns Encounter Bundle.</li>
  <li>UC3/4: Facility POST updated Bundle/Encounter → FHIR Server stores updates and makes them discoverable.</li>
  <li>UC5: Agency GET /Encounter (or reports) → FHIR Server returns 200 Bundles for reporting.</li>
  <li>UC6: Health center GET /Patient or /Encounter → FHIR Server returns patient history for follow-up.</li>
</ul>

<p>Quick implementation tips</p>
<ul>
  <li>Return clear OperationOutcome (4xx/422) on validation errors; consider 'accept but quarantine' for non-critical warnings.</li>
  <li>Use a stable IncidentNo / Encounter.identifier and idempotency keys to avoid duplicates.</li>
  <li>Secure APIs with OAuth2/SMART scopes, log/audit access, and protect sensitive attachments.</li>
  <li>Support Subscriptions for push notifications or simple polling for facility notifications; use paging for large result sets.</li>
</ul>

<p>When to choose unified vs split</p>
<ul>
  <li>Unified server: simpler operations and discovery (single endpoint to secure and scale).</li>
  <li>FHIR Server + NHDR split: use when you need a separate ingest/validation layer for quarantining, policy enforcement, or staged acceptance workflows.</li>
</ul>

<h4 id="b-ems--fhir--facility-cropped">b EMS ↔ FHIR ↔ Facility (cropped)</h4>
<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1281px" preserveAspectRatio="none" style="width:1159px;height:1281px;background:#FFFFFF;" version="1.1" viewBox="0 0 1159 1281" width="1159px" zoomAndPan="magnify"><title>Road Safety Data Exchange - Scene to Facility EHR</title><defs /><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="401.8369" x="379.7139" y="27.9951">Road Safety Data Exchange - Scene to Facility EHR</text><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="587.1499" x="10" y="186.8594" /><rect fill="none" height="350.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="581.0728" x="476.353" y="341.6563" /><rect fill="none" height="357.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="675.9116" x="476.353" y="706.0547" /><g><title>EMS</title><rect fill="#000000" fill-opacity="0.00000" height="960.9922" width="8" x="43.5" y="119.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="119.5938" y2="1080.5859" /></g><g><title>FHIR Server</title><rect fill="#000000" fill-opacity="0.00000" height="960.9922" width="8" x="532.7515" y="119.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="536.353" x2="536.353" y1="119.5938" y2="1080.5859" /></g><g><title>Facility EHR</title><rect fill="#000000" fill-opacity="0.00000" height="960.9922" width="8" x="998.7642" y="119.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1002.1025" x2="1002.1025" y1="119.5938" y2="1080.5859" /></g><g><title>ONEISS API</title><rect fill="#000000" fill-opacity="0.00000" height="960.9922" width="8" x="1095.8452" y="119.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1099.4258" x2="1099.4258" y1="119.5938" y2="1080.5859" /></g><g class="participant participant-head" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="116.292">EMS</text><ellipse cx="47.5" cy="58.7969" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,78.7969 C51.5,78.7969 54.5,78.7969 58.5,74.7969 C66.5,74.7969 74.5,82.7969 74.5,90.7969 L74.5,94.7969 C74.5,98.7969 70.5,102.7969 66.5,102.7969 L28.5,102.7969 C24.5,102.7969 20.5,98.7969 20.5,94.7969 L20.5,90.7969 C20.5,82.7969 28.5,74.7969 36.5,74.7969 C40.5,78.7969 43.5,78.7969 47.5,78.7969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EMS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.8115" x="29.5942" y="1092.5811">EMS</text><ellipse cx="47.5" cy="1112.3828" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M47.5,1132.3828 C51.5,1132.3828 54.5,1132.3828 58.5,1128.3828 C66.5,1128.3828 74.5,1136.3828 74.5,1144.3828 L74.5,1148.3828 C74.5,1152.3828 70.5,1156.3828 66.5,1156.3828 L28.5,1156.3828 C24.5,1156.3828 20.5,1152.3828 20.5,1148.3828 L20.5,1144.3828 C20.5,1136.3828 28.5,1128.3828 36.5,1128.3828 C40.5,1132.3828 43.5,1132.3828 47.5,1132.3828" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="490.353" y="84.2969" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="486.353" y="88.2969" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="493.353" y="108.292">FHIR Server</text></g><g class="participant participant-tail" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="490.353" y="1079.5859" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="486.353" y="1083.5859" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="493.353" y="1103.5811">FHIR Server</text></g><g class="participant participant-head" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="958.1025" y="116.292">Facility EHR</text><ellipse cx="1002.7642" cy="58.7969" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M1002.7642,78.7969 C1006.7642,78.7969 1009.7642,78.7969 1013.7642,74.7969 C1021.7642,74.7969 1029.7642,82.7969 1029.7642,90.7969 L1029.7642,94.7969 C1029.7642,98.7969 1025.7642,102.7969 1021.7642,102.7969 L983.7642,102.7969 C979.7642,102.7969 975.7642,98.7969 975.7642,94.7969 L975.7642,90.7969 C975.7642,82.7969 983.7642,74.7969 991.7642,74.7969 C995.7642,78.7969 998.7642,78.7969 1002.7642,78.7969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-tail" data-participant="EHR"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3232" x="958.1025" y="1092.5811">Facility EHR</text><ellipse cx="1002.7642" cy="1112.3828" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;" /><path d="M1002.7642,1132.3828 C1006.7642,1132.3828 1009.7642,1132.3828 1013.7642,1128.3828 C1021.7642,1128.3828 1029.7642,1136.3828 1029.7642,1144.3828 L1029.7642,1148.3828 C1029.7642,1152.3828 1025.7642,1156.3828 1021.7642,1156.3828 L983.7642,1156.3828 C979.7642,1156.3828 975.7642,1152.3828 975.7642,1148.3828 L975.7642,1144.3828 C975.7642,1136.3828 983.7642,1128.3828 991.7642,1128.3828 C995.7642,1132.3828 998.7642,1132.3828 1002.7642,1132.3828" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /></g><g class="participant participant-head" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="1057.4258" y="116.292">ONEISS API</text><path d="M1081.8452,67.2969 C1081.8452,57.2969 1099.8452,57.2969 1099.8452,57.2969 C1099.8452,57.2969 1117.8452,57.2969 1117.8452,67.2969 L1117.8452,93.2969 C1117.8452,103.2969 1099.8452,103.2969 1099.8452,103.2969 C1099.8452,103.2969 1081.8452,103.2969 1081.8452,93.2969 L1081.8452,67.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M1081.8452,67.2969 C1081.8452,77.2969 1099.8452,77.2969 1099.8452,77.2969 C1099.8452,77.2969 1117.8452,77.2969 1117.8452,67.2969" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-tail" data-participant="ETL"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="1057.4258" y="1092.5811">ONEISS API</text><path d="M1081.8452,1105.8828 C1081.8452,1095.8828 1099.8452,1095.8828 1099.8452,1095.8828 C1099.8452,1095.8828 1117.8452,1095.8828 1117.8452,1105.8828 L1117.8452,1131.8828 C1117.8452,1141.8828 1099.8452,1141.8828 1099.8452,1141.8828 C1099.8452,1141.8828 1081.8452,1141.8828 1081.8452,1131.8828 L1081.8452,1105.8828" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M1081.8452,1105.8828 C1081.8452,1115.8828 1099.8452,1115.8828 1099.8452,1115.8828 C1099.8452,1115.8828 1117.8452,1115.8828 1117.8452,1105.8828" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><path d="M355,144.5938 L355,164.5938 A10,10 0 0 0 365,174.5938 L706,174.5938 A10,10 0 0 0 716,164.5938 L716,144.5938 L706,134.5938 L365,134.5938 A10,10 0 0 0 355,144.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M706,134.5938 L706,139.5938 A5,5 0 0 0 711,144.5938 L716,144.5938 L706,134.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.7114" x="361" y="151.6606">ONEISS / NHDR FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.7866" x="361" y="166.7935">FHIR Server &#8212; supports Subscription delivery to ETL</text><path d="M20,186.8594 L307.9985,186.8594 L307.9985,193.9922 L297.9985,203.9922 L10,203.9922 L10,196.8594 A10,10 0 0 1 20,186.8594" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="587.1499" x="10" y="186.8594" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="252.9985" x="25" y="199.9263">Scene to EMS Transport Reporting</text><path d="M52,218.9922 L52,223.9922 A10,10 0 0 0 62,233.9922 L294,233.9922 A10,10 0 0 0 304,223.9922 L304,218.9922 L294,208.9922 L62,208.9922 A10,10 0 0 0 52,218.9922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M294,208.9922 L294,213.9922 A5,5 0 0 0 299,218.9922 L304,218.9922 L294,208.9922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.8672" x="58" y="226.0591">EMS* (Electronic Reporting system)</text><g class="message" data-participant-1="EMS" data-participant-2="FHIR"><polygon fill="#181818" points="524.7515,271.3906,534.7515,275.3906,524.7515,279.3906,528.7515,275.3906" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="47.5" x2="530.7515" y1="275.3906" y2="275.3906" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.6016" x="54.5" y="255.1919">POST Bundle.runreport</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="465.2515" x="54.5" y="270.3247">(Encounter.transport-runreport + Observations + DocumentReference)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EMS"><polygon fill="#181818" points="58.5,315.6563,48.5,319.6563,58.5,323.6563,54.5,319.6563" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="52.5" x2="535.7515" y1="319.6563" y2="319.6563" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.4233" x="64.5" y="299.4575">201 Created (Encounter id)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.5928" x="64.5" y="314.5903">Validate &amp; index</text></g><path d="M486.353,341.6563 L579.2944,341.6563 L579.2944,348.7891 L569.2944,358.7891 L476.353,358.7891 L476.353,351.6563 A10,10 0 0 1 486.353,341.6563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="350.3984" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="581.0728" x="476.353" y="341.6563" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53.4155" x="491.353" y="354.7231">Facility</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="66.2632" x="594.2944" y="353.8667">[Retrieval]</text><path d="M758,373.7891 L758,378.7891 A10,10 0 0 0 768,388.7891 L987,388.7891 A10,10 0 0 0 997,378.7891 L997,373.7891 L987,363.7891 L768,363.7891 A10,10 0 0 0 758,373.7891" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M987,363.7891 L987,368.7891 A5,5 0 0 0 992,373.7891 L997,373.7891 L987,363.7891" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.4419" x="764" y="380.856">Facility EHR (iHOMIS / other EMR)</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,411.0547,537.7515,415.0547,547.7515,419.0547,543.7515,415.0547" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="541.7515" x2="1001.7642" y1="415.0547" y2="415.0547" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7949" x="553.7515" y="409.9888">GET /Encounter?identifier=IncidentNo|{system}|{value}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="990.7642,440.1875,1000.7642,444.1875,990.7642,448.1875,994.7642,444.1875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="536.7515" x2="996.7642" y1="444.1875" y2="444.1875" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.2285" x="543.7515" y="439.1216">200 Bundle (Encounter + subject)</text></g><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,469.3203,537.7515,473.3203,547.7515,477.3203,543.7515,473.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="541.7515" x2="1001.7642" y1="473.3203" y2="473.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442.0127" x="553.7515" y="468.2544">GET /Observation?encounter={Encounter/id}&amp;category=vital-signs</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="990.7642,498.4531,1000.7642,502.4531,990.7642,506.4531,994.7642,502.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="536.7515" x2="996.7642" y1="502.4531" y2="502.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.917" x="543.7515" y="497.3872">200 Bundle (Vitals at scene)</text></g><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,527.5859,537.7515,531.5859,547.7515,535.5859,543.7515,531.5859" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="541.7515" x2="1001.7642" y1="531.5859" y2="531.5859" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405.647" x="553.7515" y="526.52">GET /DocumentReference?context-encounter={Encounter/id}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="990.7642,556.7188,1000.7642,560.7188,990.7642,564.7188,994.7642,560.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="536.7515" x2="996.7642" y1="560.7188" y2="560.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.2114" x="543.7515" y="555.6528">200 Bundle (Run form, attachments)</text></g><path d="M581,583.7188 L581,588.7188 A10,10 0 0 0 591,598.7188 L986,598.7188 A10,10 0 0 0 996,588.7188 L996,583.7188 L986,573.7188 L591,573.7188 A10,10 0 0 0 581,583.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M986,573.7188 L986,578.7188 A5,5 0 0 0 991,583.7188 L996,583.7188 L986,573.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="394.8242" x="587" y="590.7856">Prefill intake form (triage, vitals, timestamps, handoff notes)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="476.353" x2="1057.4258" y1="604.8516" y2="604.8516" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.168" x="481.353" y="615.062">[Submission]</text><g class="message" data-participant-1="EHR" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,650.9219,537.7515,654.9219,547.7515,658.9219,543.7515,654.9219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="541.7515" x2="1001.7642" y1="654.9219" y2="654.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.1045" x="553.7515" y="634.7231">POST Bundle.facility</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.4253" x="553.7515" y="649.856">(Encounter + clinical resources)</text></g><g class="message" data-participant-1="FHIR" data-participant-2="EHR"><polygon fill="#181818" points="990.7642,680.0547,1000.7642,684.0547,990.7642,688.0547,994.7642,684.0547" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="536.7515" x2="996.7642" y1="684.0547" y2="684.0547" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="543.7515" y="678.9888">201 Created</text></g><path d="M486.353,706.0547 L719.6157,706.0547 L719.6157,713.1875 L709.6157,723.1875 L476.353,723.1875 L476.353,716.0547 A10,10 0 0 1 486.353,706.0547" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="357.5313" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="675.9116" x="476.353" y="706.0547" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="193.7368" x="491.353" y="719.1216">ONEISS ETL (Subscription)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82.6987" x="734.6157" y="718.2651">[Hook based]</text><path d="M670,738.1875 L670,773.1875 A10,10 0 0 0 680,783.1875 L1084,783.1875 A10,10 0 0 0 1094,773.1875 L1094,738.1875 L1084,728.1875 L680,728.1875 A10,10 0 0 0 670,738.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M1084,728.1875 L1084,733.1875 A5,5 0 0 0 1089,738.1875 L1094,738.1875 L1084,728.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.3374" x="676" y="745.2544">ONEISS ETL subscribes to relevant events on the FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.1777" x="676" y="760.3872">(e.g. Encounter updates, Bundle.facility submissions) and pull</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.0493" x="676" y="775.52">resources referenced by notification.</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="1087.8452,805.7188,1097.8452,809.7188,1087.8452,813.7188,1091.8452,809.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="536.7515" x2="1093.8452" y1="809.7188" y2="809.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.041" x="543.7515" y="804.6528">POST /notifications (Subscription delivery)</text></g><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,834.8516,537.7515,838.8516,547.7515,842.8516,543.7515,838.8516" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="541.7515" x2="1098.8452" y1="838.8516" y2="838.8516" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="553.7515" y="833.7856">200 OK</text></g><path d="M542,861.8516 L542,866.8516 A10,10 0 0 0 552,876.8516 L1083,876.8516 A10,10 0 0 0 1093,866.8516 L1093,861.8516 L1083,851.8516 L552,851.8516 A10,10 0 0 0 542,861.8516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M1083,851.8516 L1083,856.8516 A5,5 0 0 0 1088,861.8516 L1093,861.8516 L1083,851.8516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="530.8608" x="548" y="868.9185">After transformation of the bundle, ETL returns a SOAP format API call to ONEISS.</text><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,899.1172,537.7515,903.1172,547.7515,907.1172,543.7515,903.1172" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="541.7515" x2="1098.8452" y1="903.1172" y2="903.1172" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7949" x="553.7515" y="898.0513">GET /Encounter?identifier=IncidentNo|{system}|{value}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="1087.8452,928.25,1097.8452,932.25,1087.8452,936.25,1091.8452,932.25" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="536.7515" x2="1093.8452" y1="932.25" y2="932.25" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322.5562" x="543.7515" y="927.1841">200 Bundle (raw run-report + facility submission)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="476.353" x2="1152.2646" y1="941.25" y2="941.25" /><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="272.8516" x="481.353" y="951.4604">[Alternative (Scheduled or Manual Trigger)]</text><path d="M764,970.0547 L764,990.0547 A10,10 0 0 0 774,1000.0547 L1083,1000.0547 A10,10 0 0 0 1093,990.0547 L1093,970.0547 L1083,960.0547 L774,960.0547 A10,10 0 0 0 764,970.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M1083,960.0547 L1083,965.0547 A5,5 0 0 0 1088,970.0547 L1093,970.0547 L1083,960.0547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.8525" x="770" y="977.1216">ETL may just loop api calls looking for changes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264.7798" x="770" y="992.2544">or new submissions or by button trigger.</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="1087.8452,1022.4531,1097.8452,1026.4531,1087.8452,1030.4531,1091.8452,1026.4531" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="536.7515" x2="1093.8452" y1="1026.4531" y2="1026.4531" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.0967" x="543.7515" y="1021.3872">POST /SOAP ONEISS  (transformed/normalized)</text></g><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="547.7515,1051.5859,537.7515,1055.5859,547.7515,1059.5859,543.7515,1055.5859" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="541.7515" x2="1098.8452" y1="1055.5859" y2="1055.5859" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="553.7515" y="1050.52">201 Created</text></g><rect fill="#DDDDDD" height="91.4844" rx="10" ry="10" style="stroke:#000000;stroke-width:1;" width="651.04" x="12" y="1169.8828" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.6455" x="17" y="1187.8779">Key concepts</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401.4814" x="17" y="1204.1748">- EMS submits run reports to ONEISS/NHDR (FHIR Server)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="547.0459" x="17" y="1220.4717">- Facility systems retrieve scene data (Encounters, Observations, Documents)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="641.04" x="17" y="1236.7686">- ONEISS ETL subscribes to FHIR Server notifications and can pull or accept pushed content</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="401.0029" x="17" y="1253.0654">- Use standard FHIR endpoints and Bundles for exchange</text></g></svg>
</div>
<p>Brief summary</p>

<p>This cropped diagram focuses on the three-party interaction most implementers need to implement first:</p>
<ul>
  <li>EMS posts the run-report bundle to the FHIR endpoint (UC1).</li>
  <li>The facility EHR retrieves the encounter and related resources to prefill intake (UC2).</li>
  <li>The facility posts its intake/clinical bundle back to the same FHIR Server (UC3/4).</li>
</ul>

<h3 id="ems-decision-flow-submitupdatecancel">EMS decision flow (submit/update/cancel)</h3>

<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="ACTIVITY" height="531px" preserveAspectRatio="none" style="width:568px;height:531px;background:#FFFFFF;" version="1.1" viewBox="0 0 568 531" width="568px" zoomAndPan="magnify"><defs /><g><ellipse cx="294.3774" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;" /><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="187.4609" x="200.647" y="50" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="167.4609" x="210.647" y="71.1387">EMS POST Bundle.runreport</text><polygon fill="#F1F1F1" points="232.2339,103.9688,356.521,103.9688,368.521,115.9688,356.521,127.9688,232.2339,127.9688,220.2339,115.9688,232.2339,103.9688" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="124.2871" x="232.2339" y="119.7769">FHIR Server validates?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="201.0161" y="113.3745">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="368.521" y="113.3745">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="232.9238" x="30.8779" y="137.9688" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="212.9238" x="40.8779" y="159.1074">Store Bundle, index by Incident No.</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="241.1738" x="26.7529" y="240.3398" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="221.1738" x="36.7529" y="261.4785">EMS POST updated Bundle.runreport</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="184.793" x="36.7529" y="275.4473">with same Encounter.identifier</text><polygon fill="#F1F1F1" points="41.113,191.9375,253.5667,191.9375,265.5667,203.9375,253.5667,215.9375,41.113,215.9375,29.113,203.9375,41.113,191.9375" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="151.3398" y="226.1479">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="212.4536" x="41.113" y="207.7456">Does EMS update the run report later?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="265.5667" y="201.3433">No</text><polygon fill="#F1F1F1" points="147.3398,308.2773,159.3398,320.2773,147.3398,332.2773,135.3398,320.2773,147.3398,308.2773" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="32.6455" x="159.3398" y="317.6831">:Done</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="272.6797" x="11" y="400.6797" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="252.6797" x="21" y="421.8184">EMS POST Task or Bundle with cancel flag</text><polygon fill="#F1F1F1" points="82.5671,352.2773,212.1125,352.2773,224.1125,364.2773,212.1125,376.2773,82.5671,376.2773,70.5671,364.2773,82.5671,352.2773" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="151.3398" y="386.4878">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="129.5454" x="82.5671" y="368.0854">Is cancellation needed?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="224.1125" y="361.6831">No</text><polygon fill="#F1F1F1" points="147.3398,454.6484,159.3398,466.6484,147.3398,478.6484,135.3398,466.6484,147.3398,454.6484" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="32.6455" x="159.3398" y="464.0542">:Done</text><ellipse cx="147.3398" cy="509.6484" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;" /><ellipse cx="147.3398" cy="509.6484" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;" /><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="231.4707" x="325.6797" y="137.9688" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="211.4707" x="335.6797" y="159.1074">Return OperationOutcome 4xx/422</text><ellipse cx="441.415" cy="202.9375" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;" /><ellipse cx="441.415" cy="202.9375" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="294.3774" x2="294.3774" y1="30" y2="50" /><polygon fill="#181818" points="290.3774,40,294.3774,50,298.3774,40,294.3774,44" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="215.9375" y2="240.3398" /><polygon fill="#181818" points="143.3398,230.3398,147.3398,240.3398,151.3398,230.3398,147.3398,234.3398" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#008000;stroke-width:1;" x1="265.5667" x2="277.9268" y1="203.9375" y2="203.9375" /><polygon fill="#008000" points="273.9268,254.3086,277.9268,264.3086,281.9268,254.3086,277.9268,258.3086" style="stroke:#008000;stroke-width:1;" /><line style="stroke:#008000;stroke-width:1;" x1="277.9268" x2="277.9268" y1="203.9375" y2="320.2773" /><line style="stroke:#008000;stroke-width:1;" x1="277.9268" x2="159.3398" y1="320.2773" y2="320.2773" /><polygon fill="#008000" points="169.3398,316.2773,159.3398,320.2773,169.3398,324.2773,165.3398,320.2773" style="stroke:#008000;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="288.2773" y2="308.2773" /><polygon fill="#181818" points="143.3398,298.2773,147.3398,308.2773,151.3398,298.2773,147.3398,302.2773" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="171.9375" y2="191.9375" /><polygon fill="#181818" points="143.3398,181.9375,147.3398,191.9375,151.3398,181.9375,147.3398,185.9375" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="376.2773" y2="400.6797" /><polygon fill="#181818" points="143.3398,390.6797,147.3398,400.6797,151.3398,390.6797,147.3398,394.6797" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#008000;stroke-width:1;" x1="224.1125" x2="293.6797" y1="364.2773" y2="364.2773" /><polygon fill="#008000" points="289.6797,407.6641,293.6797,417.6641,297.6797,407.6641,293.6797,411.6641" style="stroke:#008000;stroke-width:1;" /><line style="stroke:#008000;stroke-width:1;" x1="293.6797" x2="293.6797" y1="364.2773" y2="466.6484" /><line style="stroke:#008000;stroke-width:1;" x1="293.6797" x2="159.3398" y1="466.6484" y2="466.6484" /><polygon fill="#008000" points="169.3398,462.6484,159.3398,466.6484,169.3398,470.6484,165.3398,466.6484" style="stroke:#008000;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="434.6484" y2="454.6484" /><polygon fill="#181818" points="143.3398,444.6484,147.3398,454.6484,151.3398,444.6484,147.3398,448.6484" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="332.2773" y2="352.2773" /><polygon fill="#181818" points="143.3398,342.2773,147.3398,352.2773,151.3398,342.2773,147.3398,346.2773" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="478.6484" y2="498.6484" /><polygon fill="#181818" points="143.3398,488.6484,147.3398,498.6484,151.3398,488.6484,147.3398,492.6484" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="441.415" x2="441.415" y1="171.9375" y2="191.9375" /><polygon fill="#181818" points="437.415,181.9375,441.415,191.9375,445.415,181.9375,441.415,185.9375" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="220.2339" x2="147.3398" y1="115.9688" y2="115.9688" /><line style="stroke:#181818;stroke-width:1;" x1="147.3398" x2="147.3398" y1="115.9688" y2="137.9688" /><polygon fill="#181818" points="143.3398,127.9688,147.3398,137.9688,151.3398,127.9688,147.3398,131.9688" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="368.521" x2="441.415" y1="115.9688" y2="115.9688" /><line style="stroke:#181818;stroke-width:1;" x1="441.415" x2="441.415" y1="115.9688" y2="137.9688" /><polygon fill="#181818" points="437.415,127.9688,441.415,137.9688,445.415,127.9688,441.415,131.9688" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="294.3774" x2="294.3774" y1="83.9688" y2="103.9688" /><polygon fill="#181818" points="290.3774,93.9688,294.3774,103.9688,298.3774,93.9688,294.3774,97.9688" style="stroke:#181818;stroke-width:1;" /></g></svg>
</div>
<p>How the decision flow works</p>

<p>When EMS submits a run report, the FHIR Server validates and stores it. If validation fails, the FHIR Server returns an error describing what to fix. If validation succeeds, the bundle is stored and indexed so the hospital can find it later.</p>

<p>EMS may later submit updates (for example to correct timestamps or add missing data) using the same Encounter identifier. If the incident is cancelled (e.g., a false alarm), EMS should send a cancellation task or a flagged bundle and the FHIR Server should mark the record accordingly.</p>

<p>Quick links</p>
<ul>
  <li>Retrieve Encounter by Incident No.</li>
  <li>Fetch Observations by Encounter</li>
  <li>Fetch DocumentReference for run form</li>
</ul>

<p>Recommended API calls (illustrative):</p>
<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>GET /Encounter?identifier=IncidentSystem</td>
          <td>{incidentNo}&amp;_include=Encounter:subject&amp;_revinclude=Observation:encounter&amp;_revinclude=DocumentReference:encounter</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>GET /Observation?encounter={Encounter/id}&amp;category=vital-signs</li>
  <li>GET /DocumentReference?context-encounter={Encounter/id}</li>
</ul>

<p>Example: see <code class="language-plaintext highlighter-rouge">runreport-bundle.json</code> for a Bundle.runreport example.</p>

<h3 id="facility-retrieval-alternatives">Facility retrieval alternatives</h3>
<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="ACTIVITY" height="665px" preserveAspectRatio="none" style="width:869px;height:665px;background:#FFFFFF;" version="1.1" viewBox="0 0 869 665" width="869px" zoomAndPan="magnify"><defs /><g><ellipse cx="508.1714" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;" /><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="136.5254" x="439.9087" y="50" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116.5254" x="449.9087" y="71.1387">Facility EHR arrives</text><polygon fill="#F1F1F1" points="433.4783,103.9688,582.8645,103.9688,594.8645,115.9688,582.8645,127.9688,433.4783,127.9688,421.4783,115.9688,433.4783,103.9688" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149.3862" x="433.4783" y="119.7769">Do they have Incident No.?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="402.2605" y="113.3745">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="594.8645" y="113.3745">No</text><rect fill="#F1F1F1" height="61.9063" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="313.6602" x="132.9443" y="137.9688" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="293.6602" x="142.9443" y="159.1074">GET /Encounter?identifier=IncidentSystem|value</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="177.7852" x="142.9443" y="173.0762">&amp;_include=Encounter:subject</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="226.582" x="142.9443" y="187.0449">&amp;_revinclude=Observation:encounter</text><polygon fill="#F1F1F1" points="241.2197,219.875,338.3291,219.875,350.3291,231.875,338.3291,243.875,241.2197,243.875,229.2197,231.875,241.2197,219.875" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97.1094" x="241.2197" y="235.6831">Encounter found?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="210.002" y="229.2808">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="350.3291" y="229.2808">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="270.5938" x="11" y="253.875" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="250.5938" x="21" y="275.0137">GET related resources or use $everything</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="263.3164" x="301.5938" y="253.875" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="243.3164" x="311.5938" y="275.0137">Search by time window + demographics</text><polygon fill="#F1F1F1" points="289.7744,293.8438,301.7744,305.8438,289.7744,317.8438,277.7744,305.8438,289.7744,293.8438" style="stroke:#181818;stroke-width:0.5;" /><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="263.3164" x="594.9102" y="137.9688" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="243.3164" x="604.9102" y="159.1074">Search by time window + demographics</text><polygon fill="#F1F1F1" points="508.1714,323.8438,520.1714,335.8438,508.1714,347.8438,496.1714,335.8438,508.1714,323.8438" style="stroke:#181818;stroke-width:0.5;" /><polygon fill="#F1F1F1" points="469.2014,367.8438,547.1414,367.8438,559.1414,379.8438,547.1414,391.8438,469.2014,391.8438,457.2014,379.8438,469.2014,367.8438" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77.9399" x="469.2014" y="383.6519">Single match?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="19.2178" x="437.9836" y="377.2495">Yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="14.9585" x="559.1414" y="377.2495">No</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="68.0703" x="404.3594" y="401.8438" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48.0703" x="414.3594" y="422.9824">FetchAll</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="171.0371" x="492.4297" y="401.8438" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151.0371" x="502.4297" y="422.9824">Manual reconcile by staff</text><polygon fill="#F1F1F1" points="508.1714,441.8125,520.1714,453.8125,508.1714,465.8125,496.1714,453.8125,508.1714,441.8125" style="stroke:#181818;stroke-width:0.5;" /><rect fill="none" height="136.2344" style="stroke:#000000;stroke-width:1.5;" width="476.0957" x="270.1235" y="475.8125" /><path d="M442.313,475.8125 L442.313,485.1094 L432.313,495.1094 L270.1235,495.1094" fill="none" style="stroke:#000000;stroke-width:1.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162.1895" x="273.1235" y="489.8076">(Optional) Notifications</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="456.0957" x="280.1235" y="512.1094" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="436.0957" x="290.1235" y="533.248">Subscribe (criteria: Encounter.class=AMB &amp; service-provider=Org/&lt;id&gt;)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="179.3457" x="418.4985" y="566.0781" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="159.3457" x="428.4985" y="587.2168">On create -&gt; notify facility</text><ellipse cx="508.1714" cy="643.0469" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;" /><ellipse cx="508.1714" cy="643.0469" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="30" y2="50" /><polygon fill="#181818" points="504.1714,40,508.1714,50,512.1714,40,508.1714,44" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="229.2197" x2="146.2969" y1="231.875" y2="231.875" /><line style="stroke:#181818;stroke-width:1;" x1="146.2969" x2="146.2969" y1="231.875" y2="253.875" /><polygon fill="#181818" points="142.2969,243.875,146.2969,253.875,150.2969,243.875,146.2969,247.875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="350.3291" x2="433.252" y1="231.875" y2="231.875" /><line style="stroke:#181818;stroke-width:1;" x1="433.252" x2="433.252" y1="231.875" y2="253.875" /><polygon fill="#181818" points="429.252,243.875,433.252,253.875,437.252,243.875,433.252,247.875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="146.2969" x2="146.2969" y1="287.8438" y2="305.8438" /><line style="stroke:#181818;stroke-width:1;" x1="146.2969" x2="277.7744" y1="305.8438" y2="305.8438" /><polygon fill="#181818" points="267.7744,301.8438,277.7744,305.8438,267.7744,309.8438,271.7744,305.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="433.252" x2="433.252" y1="287.8438" y2="305.8438" /><line style="stroke:#181818;stroke-width:1;" x1="433.252" x2="301.7744" y1="305.8438" y2="305.8438" /><polygon fill="#181818" points="311.7744,301.8438,301.7744,305.8438,311.7744,309.8438,307.7744,305.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="289.7744" x2="289.7744" y1="199.875" y2="219.875" /><polygon fill="#181818" points="285.7744,209.875,289.7744,219.875,293.7744,209.875,289.7744,213.875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="421.4783" x2="289.7744" y1="115.9688" y2="115.9688" /><line style="stroke:#181818;stroke-width:1;" x1="289.7744" x2="289.7744" y1="115.9688" y2="137.9688" /><polygon fill="#181818" points="285.7744,127.9688,289.7744,137.9688,293.7744,127.9688,289.7744,131.9688" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="594.8645" x2="726.5684" y1="115.9688" y2="115.9688" /><line style="stroke:#181818;stroke-width:1;" x1="726.5684" x2="726.5684" y1="115.9688" y2="137.9688" /><polygon fill="#181818" points="722.5684,127.9688,726.5684,137.9688,730.5684,127.9688,726.5684,131.9688" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="289.7744" x2="289.7744" y1="317.8438" y2="335.8438" /><line style="stroke:#181818;stroke-width:1;" x1="289.7744" x2="496.1714" y1="335.8438" y2="335.8438" /><polygon fill="#181818" points="486.1714,331.8438,496.1714,335.8438,486.1714,339.8438,490.1714,335.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="726.5684" x2="726.5684" y1="171.9375" y2="335.8438" /><line style="stroke:#181818;stroke-width:1;" x1="726.5684" x2="520.1714" y1="335.8438" y2="335.8438" /><polygon fill="#181818" points="530.1714,331.8438,520.1714,335.8438,530.1714,339.8438,526.1714,335.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="83.9688" y2="103.9688" /><polygon fill="#181818" points="504.1714,93.9688,508.1714,103.9688,512.1714,93.9688,508.1714,97.9688" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="457.2014" x2="438.3945" y1="379.8438" y2="379.8438" /><line style="stroke:#181818;stroke-width:1;" x1="438.3945" x2="438.3945" y1="379.8438" y2="401.8438" /><polygon fill="#181818" points="434.3945,391.8438,438.3945,401.8438,442.3945,391.8438,438.3945,395.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="559.1414" x2="577.9482" y1="379.8438" y2="379.8438" /><line style="stroke:#181818;stroke-width:1;" x1="577.9482" x2="577.9482" y1="379.8438" y2="401.8438" /><polygon fill="#181818" points="573.9482,391.8438,577.9482,401.8438,581.9482,391.8438,577.9482,395.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="438.3945" x2="438.3945" y1="435.8125" y2="453.8125" /><line style="stroke:#181818;stroke-width:1;" x1="438.3945" x2="496.1714" y1="453.8125" y2="453.8125" /><polygon fill="#181818" points="486.1714,449.8125,496.1714,453.8125,486.1714,457.8125,490.1714,453.8125" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="577.9482" x2="577.9482" y1="435.8125" y2="453.8125" /><line style="stroke:#181818;stroke-width:1;" x1="577.9482" x2="520.1714" y1="453.8125" y2="453.8125" /><polygon fill="#181818" points="530.1714,449.8125,520.1714,453.8125,530.1714,457.8125,526.1714,453.8125" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="347.8438" y2="367.8438" /><polygon fill="#181818" points="504.1714,357.8438,508.1714,367.8438,512.1714,357.8438,508.1714,361.8438" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="546.0781" y2="566.0781" /><polygon fill="#181818" points="504.1714,556.0781,508.1714,566.0781,512.1714,556.0781,508.1714,560.0781" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="465.8125" y2="512.1094" /><polygon fill="#181818" points="504.1714,502.1094,508.1714,512.1094,512.1714,502.1094,508.1714,506.1094" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="508.1714" x2="508.1714" y1="600.0469" y2="632.0469" /><polygon fill="#181818" points="504.1714,622.0469,508.1714,632.0469,512.1714,622.0469,508.1714,626.0469" style="stroke:#181818;stroke-width:1;" /></g></svg>
</div>
<p>If the facility cannot find the incident by identifier</p>

<p>Start by searching with the Incident Number. If that lookup doesn’t return a match, try searching by the approximate time window and patient demographics to find likely matches. If several likely matches appear or confidence is low, present a clear manual reconciliation step for staff to choose the correct record. Subscriptions are optional but useful — they let facilities get a notification automatically when matching encounters arrive.</p>

<p>How the receiving facility retrieves EMS run report data, reconciles patients, and submits the Facility bundle (Bundle.facility) to the ONEISS FHIR Server. It includes guidance on referencing the EMS Encounter, mapping diagnoses, and handling attachments.</p>

<p>Key steps</p>
<ol>
  <li>Retrieve the transport Encounter and related resources using Incident No.</li>
  <li>Prefill local chart fields and reconcile patient identity</li>
  <li>Create Encounter.facility and supporting Condition/Observation resources</li>
  <li>Submit Bundle.facility to the ONEISS FHIR Server (transaction or collection)</li>
</ol>

<h3 id="oneiss-etl--subscription-workflow--mock-script">ONEISS ETL — Subscription workflow &amp; mock script</h3>

<p>This section describes how an internal/external ETL service ONEISS API could hypothetically subscribe to events on the FHIR Server to pull or receive pushed run-report and facility-submission data, and map it to their respective stakeholders.</p>

<div class="svg-wrap">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="711px" preserveAspectRatio="none" style="width:861px;height:711px;background:#FFFFFF;" version="1.1" viewBox="0 0 861 711" width="861px" zoomAndPan="magnify"><title>ONEISS ETL &#8212; FHIR Server &#8596; ONEISS Subscription Workflow</title><defs /><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="473.3682" x="195.3953" y="27.9951">ONEISS ETL &#8212; FHIR Server &#8596; ONEISS Subscription Workflow</text><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="562.1455" x="10" y="171.8594" /><rect fill="none" height="133.6641" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="845.1587" x="10" y="326.6563" /><g><title>FHIR Server</title><rect fill="#000000" fill-opacity="0.00000" height="372.7266" width="8" x="66.3984" y="104.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="104.5938" y2="477.3203" /></g><g><title>ETL Script</title><rect fill="#000000" fill-opacity="0.00000" height="372.7266" width="8" x="513.019" y="104.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="516.8926" x2="516.8926" y1="104.5938" y2="477.3203" /></g><g><title>ONEISS API</title><rect fill="#000000" fill-opacity="0.00000" height="372.7266" width="8" x="798.7393" y="104.5938" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="802.3198" x2="802.3198" y1="104.5938" y2="477.3203" /></g><g class="participant participant-head" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="24" y="69.2969" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="20" y="73.2969" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="27" y="93.292">FHIR Server</text></g><g class="participant participant-tail" data-participant="FHIR"><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="24" y="476.3203" /><rect fill="#E2E2F0" height="30.2969" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;" width="96.7969" x="20" y="480.3203" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7969" x="27" y="500.3154">FHIR Server</text></g><g class="participant participant-head" data-participant="ETL"><path d="M476.8926,78.2969 L557.1455,78.2969 C562.1455,78.2969 562.1455,91.4453 562.1455,91.4453 C562.1455,91.4453 562.1455,104.5938 557.1455,104.5938 L476.8926,104.5938 C471.8926,104.5938 471.8926,91.4453 471.8926,91.4453 C471.8926,91.4453 471.8926,78.2969 476.8926,78.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /><path d="M557.1455,78.2969 C552.1455,78.2969 552.1455,91.4453 552.1455,91.4453 C552.1455,104.5938 557.1455,104.5938 557.1455,104.5938" fill="none" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.2529" x="476.8926" y="96.292">ETL Script</text></g><g class="participant participant-tail" data-participant="ETL"><path d="M476.8926,476.3203 L557.1455,476.3203 C562.1455,476.3203 562.1455,489.4688 562.1455,489.4688 C562.1455,489.4688 562.1455,502.6172 557.1455,502.6172 L476.8926,502.6172 C471.8926,502.6172 471.8926,489.4688 471.8926,489.4688 C471.8926,489.4688 471.8926,476.3203 476.8926,476.3203" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;" /><path d="M557.1455,476.3203 C552.1455,476.3203 552.1455,489.4688 552.1455,489.4688 C552.1455,502.6172 557.1455,502.6172 557.1455,502.6172" fill="none" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.2529" x="476.8926" y="494.3154">ETL Script</text></g><g class="participant participant-head" data-participant="ONEISS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="760.3198" y="101.292">ONEISS API</text><path d="M784.7393,52.2969 C784.7393,42.2969 802.7393,42.2969 802.7393,42.2969 C802.7393,42.2969 820.7393,42.2969 820.7393,52.2969 L820.7393,78.2969 C820.7393,88.2969 802.7393,88.2969 802.7393,88.2969 C802.7393,88.2969 784.7393,88.2969 784.7393,78.2969 L784.7393,52.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M784.7393,52.2969 C784.7393,62.2969 802.7393,62.2969 802.7393,62.2969 C802.7393,62.2969 820.7393,62.2969 820.7393,52.2969" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><g class="participant participant-tail" data-participant="ONEISS"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.8389" x="760.3198" y="489.3154">ONEISS API</text><path d="M784.7393,502.6172 C784.7393,492.6172 802.7393,492.6172 802.7393,492.6172 C802.7393,492.6172 820.7393,492.6172 820.7393,502.6172 L820.7393,528.6172 C820.7393,538.6172 802.7393,538.6172 802.7393,538.6172 C802.7393,538.6172 784.7393,538.6172 784.7393,528.6172 L784.7393,502.6172" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;" /><path d="M784.7393,502.6172 C784.7393,512.6172 802.7393,512.6172 802.7393,512.6172 C802.7393,512.6172 820.7393,512.6172 820.7393,502.6172" fill="none" style="stroke:#181818;stroke-width:1.5;" /></g><path d="M75,129.5938 L75,149.5938 A10,10 0 0 0 85,159.5938 L370,159.5938 A10,10 0 0 0 380,149.5938 L380,129.5938 L370,119.5938 L85,119.5938 A10,10 0 0 0 75,129.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M370,119.5938 L370,124.5938 A5,5 0 0 0 375,129.5938 L380,129.5938 L370,119.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.4614" x="81" y="136.6606">FHIR Server hosts Subscription resources</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.8955" x="81" y="151.7935">and delivers notifications to Script Endpoint</text><path d="M20,171.8594 L211.1333,171.8594 L211.1333,178.9922 L201.1333,188.9922 L10,188.9922 L10,181.8594 A10,10 0 0 1 20,171.8594" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="140.7969" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="562.1455" x="10" y="171.8594" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156.1333" x="25" y="184.9263">Subscription delivery</text><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="505.019,206.125,515.019,210.125,505.019,214.125,509.019,210.125" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="70.3984" x2="511.019" y1="210.125" y2="210.125" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.041" x="77.3984" y="205.0591">POST /notifications (Subscription delivery)</text></g><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="81.3984,235.2578,71.3984,239.2578,81.3984,243.2578,77.3984,239.2578" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="75.3984" x2="516.019" y1="239.2578" y2="239.2578" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="87.3984" y="234.1919">200 OK</text></g><path d="M125,262.2578 L125,297.2578 A10,10 0 0 0 135,307.2578 L501,307.2578 A10,10 0 0 0 511,297.2578 L511,262.2578 L501,252.2578 L135,252.2578 A10,10 0 0 0 125,262.2578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><path d="M501,252.2578 L501,257.2578 A5,5 0 0 0 506,262.2578 L511,262.2578 L501,252.2578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.1909" x="131" y="269.3247">Notification may include resource references or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.7563" x="131" y="284.4575">inline resources (application/fhir+json).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.3457" x="131" y="299.5903">ETL Script may choose to pull full resources after notify.</text><path d="M20,326.6563 L178.6714,326.6563 L178.6714,333.7891 L168.6714,343.7891 L10,343.7891 L10,336.6563 A10,10 0 0 1 20,326.6563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="133.6641" rx="10" ry="10" style="stroke:#000000;stroke-width:1.5;" width="845.1587" x="10" y="326.6563" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="123.6714" x="25" y="339.7231">Pull &amp; Transform</text><g class="message" data-participant-1="ETL" data-participant-2="FHIR"><polygon fill="#181818" points="81.3984,360.9219,71.3984,364.9219,81.3984,368.9219,77.3984,364.9219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="75.3984" x2="516.019" y1="364.9219" y2="364.9219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.7949" x="87.3984" y="359.856">GET /Encounter?identifier=IncidentNo|{system}|{value}</text></g><g class="message" data-participant-1="FHIR" data-participant-2="ETL"><polygon fill="#181818" points="505.019,390.0547,515.019,394.0547,505.019,398.0547,509.019,394.0547" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="70.3984" x2="511.019" y1="394.0547" y2="394.0547" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422.6206" x="77.3984" y="388.9888">200 Bundle (raw EMS + Facility data) (transformed / normalized)</text></g><g class="message" data-participant-1="ETL" data-participant-2="ONEISS"><polygon fill="#181818" points="790.7393,419.1875,800.7393,423.1875,790.7393,427.1875,794.7393,423.1875" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="517.019" x2="796.7393" y1="423.1875" y2="423.1875" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261.7202" x="524.019" y="418.1216">POST /SOAP  (transformed / normalized)</text></g><g class="message" data-participant-1="ONEISS" data-participant-2="ETL"><polygon fill="#181818" points="528.019,448.3203,518.019,452.3203,528.019,456.3203,524.019,452.3203" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="522.019" x2="801.7393" y1="452.3203" y2="452.3203" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="534.019" y="447.2544">201 Created</text></g><rect fill="#DDDDDD" height="140.375" rx="10" ry="10" style="stroke:#000000;stroke-width:1;" width="647.1504" x="12" y="551.6172" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.9131" x="17" y="569.6123">Example interactions:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="637.1504" x="17" y="585.9092">- Subscription.delivery: HTTP POST to ETL endpoint with content-type application/fhir+json</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="594.501" x="17" y="602.2061">- ETL Script can pull resources using standard GET queries or accept pushed content</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4502" x="17" y="618.5029">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.1426" x="17" y="634.7998">Operational notes:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="386.9072" x="17" y="651.0967">- Secure endpoints (OAuth2 client credentials or mTLS)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="494.6211" x="17" y="667.3936">- Support retries, backoff, and dead-letter handling on the FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="469.9092" x="17" y="683.6904">- Agree transformation rules, canonical mappings, and provenance</text></g></svg>
</div>

<p>How it works (high level)</p>
<ul>
  <li>Provision a Subscription resource on the FHIR Server with criteria (for example: Encounter updates or Bundle.facility submissions scoped to specific service-provider or organization).</li>
  <li>The FHIR Server delivers notifications to the ETL endpoint (HTTP POST with application/fhir+json). Notifications may include resource snippets or references.</li>
  <li>On notification the ETL may either pull full resources via GET queries, or accept the pushed content and perform transform/enrichment.</li>
  <li>After transformation the ETL POSTs a normalized Bundle back to the FHIR Server (POST /Bundle) or uses an agreed process operation (e.g. $process-message) so the transformed data becomes authoritative for reporting.</li>
</ul>

<p>Mock script outline (example - for reference only)</p>
<ul>
  <li>Subscribe: POST /Subscription {criteria: "Encounter?service-provider=Org/{id}", endpoint: "https://etl.example.org/notify"}</li>
  <li>On notify (ETL endpoint):
1) Validate signature and auth on incoming notification
2) If payload includes resources, extract identifiers; else call GET /Encounter?identifier=…
3) Transform: map local codes to canonical CodeSystems, normalize timestamps, deduplicate patient references
4) POST transformed Bundle to the FHIR Server: POST /Bundle (or call $process-message)</li>
</ul>

<p>Caveats and governance</p>
<ul>
  <li>The mock script is an illustrative starting point — adoption requires formal agreements, ongoing maintenance, and security provisioning (OAuth2/mTLS, retry/backoff, DLQ handling).</li>
  <li>Transformation rules, canonical mappings, and provenance policies must be agreed and versioned.</li>
  <li>There is no guarantee of compatibility without integration testing and operational support.</li>
</ul>



</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2025+ <a style="color:var(--footer-hyperlink-text-color)" href="https://github.com/UPM-NTHC/PH-RoadSafetyIG">UP Manila - National Institutes of Health - National Telehealth Center</a>.  Package example.fhir.ph.roadsafety#0.2.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Thu, Oct 30, 2025 05:39+0000">2025-10-30</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

